---
title: "Analysis for HEP Data (Problem 6)"
author: Eleanor Zhang
date: 2018-09-27
output: github_document
---

# Overview

This document aims to analyze a research study which examining association of depression and cognitive performance with migraine symtoms. HEP Data were collected from patients with new onset of focal epilepsy with their informations including migraine status, score of NDDIE (Neurological Disorders Depression Inventory for Epilepsy), score of CESD (a questionairre screening for depression), cognitive evaluation for both memory and language.

## Some backgrounds:

CESD: questionairre screening for depression; meausre symptoms of depression; sum of scores to all questions; longer duration of symptoms will have greater score.

nddie: The Neurological Disorders Depression Inventory for Epilepsy (NDDI-E) is a 6-item questionnaire validated to screen for depression in people with epilepsy

```{r setup, include=FALSE}
library(tidyverse)
library(readxl)
```

# Import Data and Data Cleaning

```{r data import and cleaning}
Mig <- read_excel("Migraine.xlsx")
Mig <- janitor::clean_names(Mig) # rename variable names
Mig$migraine_status <- ifelse(Mig$migraine == 1, "have_migraine", "no_migraine")
```

# Exploratory Analysis

Have a look at the data:

```{r}
head(Mig)
str(Mig)
dim(Mig) # 419 observations, 5 variables
```


#### Seperate subjects with and without migraine.

```{r seperate variables}
with_Mig <- filter(Mig, migraine == 1)
no_Mig <- filter(Mig, migraine == 0)
```

#### Explore subjects with migraine

## 1. Descriptive statistics

First we can take an overall look at the distribution of each variables:

```{r}
str(Mig)
skimr::skim(Mig)
```

The `skim` function enables a rough preview of the distribution of each variable in the dataset.




Look at proportions of each variables in terms of with migraine or without migrain

```{r summary for each variable}
tbl <- table(Mig$cesd, Mig$migraine)
prop.table(tbl,1)
prop.table(tbl,2)
```

```{r}
ggplot(Mig, aes(x = migraine_status, y = cesd, fill = migraine_status)) + 
  geom_boxplot()
```



#### histograms:

```{r cesd}
par(mfrow = c(1, 2))
hist(no_Mig$cesd, freq = F, ylim = c(0, 0.1))
hist(with_Mig$cesd, freq = F, ylim = c(0, 0.1))
```

```{r nddie}
par(mfrow = c(1, 2))
hist(no_Mig$nddie, freq = F, ylim = c(0, 0.3))
hist(with_Mig$nddie, freq = F, ylim = c(0, 0.3))
```


```{r abnas}
par(mfrow = c(2, 2))
hist(no_Mig$abnas_memory, freq = F, ylim = c(0, 0.6))
hist(with_Mig$abnas_memory, freq = F, ylim = c(0, 0.6))
hist(no_Mig$abnas_language, freq = F, ylim = c(0, 0.7))
hist(with_Mig$abnas_language, freq = F, ylim = c(0, 0.7))
```


#### boxplots

```{r}
Mig$migraine_status <- ifelse(Mig$migraine == 1, "have_migraine", "no_migraine")
ggplot(Mig, aes(x = migraine, y = cesd, fill = migraine_status) ) + geom_boxplot()

ggplot(Mig, aes(x = migraine, y = nddie, fill = migraine_status)) + geom_boxplot()
ggplot(Mig, aes(x = migraine, y = abnas_memory, fill = migraine_status)) + geom_boxplot()
ggplot(Mig, aes(x = migraine, y = abnas_language, fill = migraine_status)) + geom_boxplot()
```

