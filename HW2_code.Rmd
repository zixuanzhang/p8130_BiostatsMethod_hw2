---
title: "Analysis for HEP Data (Problem 6)"
author: Eleanor Zhang
date: 2018-09-27
output: github_document
---

# Overview

This document aims to analyze a research study which examining association of depression and cognitive performance with migraine symtoms. HEP Data were collected from patients with new onset of focal epilepsy with their informations including migraine status, score of NDDIE (Neurological Disorders Depression Inventory for Epilepsy), score of CESD (a questionairre screening for depression), cognitive evaluation for both memory and language.

```{r setup, include=FALSE}
library(tidyverse)
library(readxl)
```

# Import Data and Data Cleaning

```{r data import and cleaning}
Mig <- read_excel("Migraine.xlsx")
Mig <- janitor::clean_names(Mig) # rename variable names
Mig$migraine_status <- ifelse(Mig$migraine == 1, "have_migraine", "no_migraine")
```

# Exploratory Analysis

### Part I: descriptive statistics without cutoffs

Firstly, we can have an general look at the data:

```{r}
head(Mig)
str(Mig)
skimr::skim(Mig)
```

Our data is consisted of 419 observations with 5 variables. Some variables contains missing values which need to be taken care of. 

Since we are interested in the relationship of cognitive performance, with or without migraine, and depression conditions, we can look at and compare the subset of each variable corresponding to migraine status. So here we subset the whole dataset into two subsets:

```{r seperate variables}
with_Mig <- filter(Mig, migraine == 1)
str(with_Mig)
no_Mig <- filter(Mig, migraine == 0)
str(no_Mig)
```

Since the `skim` function allows us to the general trend of each variable, we would expect the variables are significantly skewed. To better describe the data, we will use _median_ and _interquartile range_ to describe each variable in these two sets __with_Mig__ and __no_Mig__.

```{r}
#cesd
summary(no_Mig$cesd)
summary(with_Mig$cesd)
#nddie
summary(no_Mig$nddie)
summary(with_Mig$nddie)
#abnas_memory
summary(no_Mig$abnas_memory)
summary(with_Mig$abnas_memory)
#abnas_language
summary(no_Mig$abnas_language)
summary(with_Mig$abnas_language)
```

To describe the dataset in terms of sample size and missing values:

|             |         cesd      | nddie      | abnas_memory  | abnas_language |
|-------------|:---------:|:----------:|:-------------:|:--------------:|
|no migraine (sample size[NAs])|  337(63)  | 337(64)   | 337(0)       |   337(0)   |
|with migraine (sample size[NAs]) |  82(8) |  82(9)  | 82(0)   |   82(0)   |


Put all information about median and IQR together as a table:

|             |         cesd      | nddie      | abnas_memory  | abnas_language |
|-------------|:---------:|:----------:|:-------------:|:--------------:|
|no migraine (median[IQR range])|  8(3,14)  | 9(6,13)   | 2(0,4)       |   1(0,2)   |
|with migraine (median[IQR range]) |  11(6,20) |  11(8,14)  | 2(1,5)   |   1(0,3)   |


### part II: descriptive statistics with cutoffs

Now we want to further subset some variabls by cutoff values:

*    nddie: >= 16
*    cesd: >= 16


Look at proportions of each variables in terms of with migraine or without migrain

```{r summary for each variable, include = FALSE}
table(Mig$migraine)
```

```{r}
ggplot(Mig, aes(x = migraine_status, y = cesd, fill = migraine_status)) + 
  geom_boxplot()
```



#### histograms:

```{r cesd}
par(mfrow = c(1, 2))
hist(no_Mig$cesd, freq = F, ylim = c(0, 0.1))
hist(with_Mig$cesd, freq = F, ylim = c(0, 0.1))
```

```{r nddie}
par(mfrow = c(1, 2))
hist(no_Mig$nddie, freq = F, ylim = c(0, 0.3))
hist(with_Mig$nddie, freq = F, ylim = c(0, 0.3))
```


```{r abnas}
par(mfrow = c(2, 2))
hist(no_Mig$abnas_memory, freq = F, ylim = c(0, 0.6))
hist(with_Mig$abnas_memory, freq = F, ylim = c(0, 0.6))
hist(no_Mig$abnas_language, freq = F, ylim = c(0, 0.7))
hist(with_Mig$abnas_language, freq = F, ylim = c(0, 0.7))
```


#### boxplots

```{r}
Mig$migraine_status <- ifelse(Mig$migraine == 1, "have_migraine", "no_migraine")
ggplot(Mig, aes(x = migraine, y = cesd, fill = migraine_status) ) + geom_boxplot()

ggplot(Mig, aes(x = migraine, y = nddie, fill = migraine_status)) + geom_boxplot()
ggplot(Mig, aes(x = migraine, y = abnas_memory, fill = migraine_status)) + geom_boxplot()
ggplot(Mig, aes(x = migraine, y = abnas_language, fill = migraine_status)) + geom_boxplot()
```

